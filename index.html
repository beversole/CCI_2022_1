<!-- /exercises/06-js-array-functions.html -->
<!DOCTYPE html>
<html>
  <head>
    <title>Artists, Tour Guides and Tag Alongs</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500&family=Roboto&display=swap" rel="stylesheet">
    <style>
        .panel{ float:left; border-radius: 1.5em; padding:1.5em; margin:1.5em; font-size:1.5em; background-color:#ffffff;  border:solid 1px #eeeeee; font-family: 'Roboto', sans-serif;}
        .lbl{ font-size:2em; display: block; margin-bottom: .25em; font-family: 'Playfair Display', serif; }
        #canvas { position:fixed; left:0; top:0; }
    </style>


    <script src="GACC.js"></script>
  </head>
  <body>

  <canvas id="canvas" width="1740" height="2175" style="display:block;z-index:100"></canvas>
  <div style="z-index:200;position: relative" id="artist-list"></div>
<script>

let canvas, ctx;
let particles = [];
let bgAnimation;

(function() {
  canvas = document.getElementById('canvas');
  ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  GACC.loadImages(imagesReady);
})();


function imagesReady(){
  renderHtm();
  initParticles();
  step();
  drawCanvas();
  
    window.addEventListener('resize', function(event) {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      drawCanvas();
  }, true);
}

function randomIntFromInterval(min, max) {
  return Math.floor(Math.random() * (max - min + 1) + min)
}

function initParticles(){
  particles = [];
  for( let i=5; i--; )
  {
    GACC.fullCohort.forEach(element => 
            {
                let p = {};
                p.scale = randomIntFromInterval(window.innerWidth/10, window.innerWidth/5);
                p.x = - p.scale;
                p.y = randomIntFromInterval(-p.scale, window.innerHeight+p.scale);
                p.xVel = randomIntFromInterval(.05, 5);
                p.yVel = randomIntFromInterval(.05, 5);
                p.imagePos = element.imagePos;
                particles.push(p);
            }
        );
  }

}


function step(){
  particles.forEach(p => 
      {
        let isResetP = false;
        p.x += p.xVel;
        p.y += p.yVel;
        if(p.x > window.innerWidth){isResetP=true}
        if(p.y > window.innerHeight){isResetP=true}

        if(isResetP){
          p.scale = randomIntFromInterval(window.innerWidth/10, window.innerWidth/5);
          p.x = - p.scale;
          p.y = randomIntFromInterval(-p.scale, window.innerHeight+p.scale);
          p.xVel = randomIntFromInterval(1, 6);
          p.yVel = randomIntFromInterval(1, 6);
        }

      }
  );
  drawCanvas();
  bgAnimation = requestAnimationFrame(step);
}



function drawCanvas(){

  particles.forEach(p => 
      {
        ctx.drawImage(
            GACC.imageFullCohort, 
            0,GACC.iconNativeSize[0]*p.imagePos,
            GACC.iconNativeSize[0],GACC.iconNativeSize[0],
            p.x,p.y,
            p.scale,p.scale);
      }
  );

}

function renderHtm(){
  let elem = document.getElementById("artist-list");
  let markup = ``;

  markup += '<div class="panel">'
  markup += '<span class="lbl">Artists</span>'
  markup += GACC.artists.map(function(artist) {
  let htm = '';
  if(artist.site != null){
    htm = `<li><a target="_blank" href="${ artist.site }" >${ artist.name }</a></li>`;
  }else{
    htm =  `<li>${ artist.name }</li>`;
  }
  return htm
  }).join('');
  markup += '</div>'

  markup += '<div class="panel">'
  markup += '<span class="lbl">Tour Guides</span>'
  markup += GACC.tourGuides.map(function(artist) {
  let htm = '';
  if(artist.site != null){
    htm = `<li><a target="_blank" href="${ artist.site }" >${ artist.name }</a></li>`;
  }else{
    htm =  `<li>${ artist.name }</li>`;
  }
  return htm
  }).join('');
  markup += '</div>'

  markup += '<div class="panel">'
  markup += '<span class="lbl">Tag Alongs</span>'
  markup += GACC.tagAlongs.map(function(artist) {
  let htm = '';
  if(artist.site != null){
    htm = `<li><a target="_blank" href="${ artist.site }" >${ artist.name }</a></li>`;
  }else{
    htm =  `<li>${ artist.name }</li>`;
  }
  return htm
  }).join('');
  markup += '</div>'

  elem.innerHTML = markup;
}

</script>

  </body>
</html>